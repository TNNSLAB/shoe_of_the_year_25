<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Best Tennis Shoe of 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <div class="flex flex-col items-center min-h-screen py-8 space-y-6">

    <!-- Background selection -->
    <div class="flex flex-col space-y-4 w-64">
      <select id="background-select" class="w-full px-4 py-2 border border-gray-300 rounded shadow">
        <option value="quarterfinals.png">Quarter-finals</option>
        <option value="semifinals.png">Semi-finals</option>
        <option value="final.png">Final</option>
      </select>
    </div>

    <!-- Shoe dropdowns -->
    <div class="flex flex-col space-y-4 w-64">
      <select id="shoe1-select" class="w-full px-4 py-2 border border-gray-300 rounded shadow">
        <option value="">Select first shoe</option>
      </select>

      <select id="shoe2-select" class="w-full px-4 py-2 border border-gray-300 rounded shadow">
        <option value="">Select second shoe</option>
      </select>
    </div>

    <!-- Template display container -->
    <div id="canvas-container" class="relative border shadow-lg w-full max-w-md">
      <img id="template" 
           src="images/quarterfinals.png" 
           alt="Template" 
           class="pointer-events-none select-none" 
           style="width:100%; height:auto; display:block;">
      <div id="shoe-layer" class="absolute top-0 left-0 w-full h-full"></div>
    </div>

    <!-- Download Button -->
    <button id="download-btn" class="px-6 py-2 bg-blue-600 text-white rounded shadow hover:bg-blue-700">
      Download Image
    </button>
  </div>

  <script>
    const BASE_WIDTH = 1080;
    const BASE_HEIGHT = 1920;

    // Bounding boxes
    const shoeBox1 = { x: 251, y: 376, width: 650, height: 322 };
    const shoeBox2 = { x: 251, y: 732, width: 574, height: 325 };

    // Shoe data
    const shoes = [
      { name: "Asics Gel Resolution X", image: "images/Asics-Gel-Resolution-X.png" },
      { name: "Adidas Barricade 13", image: "images/adidas-Barricade-13.png" },
      { name: "Nike Zoom GP Challenge", image: "images/Nike-Zoom-GP-Challenge.png" },
      { name: "Nike Zoom Vapor", image: "images/Nike-Zoom-Vapor.png" },
      { name: "Nike Vapor Pro 3", image: "images/Nike-Vapor-Pro-3.png" },
      { name: "Asics Solution Speed FF 3", image: "images/Asics-Solution-Speed-FF-3.png" },
      { name: "K-Swiss Hypercourt Express 2", image: "images/K-Swiss-Hypercourt-Express-2.png" },
      { name: "Asics FF 3 Novak", image: "images/Asics-FF-3-Novak.png" },
      { name: "Wilson Rush Pro 4.5", image: "images/Wilson-Rush-Pro-4.5.png" },
      { name: "ON Roger Pro Fire", image: "images/ON-Roger-Pro-Fire.png" },
      { name: "On Running Roger Pro 2", image: "images/On-Running-Roger-Pro-2.png" },
      { name: "Head Endure Pro BOA", image: "images/Head-Endure-Pro-BOA.png" },
      { name: "Adidas Adizero Ubersonic 5", image: "images/Adidas-adizero-Ubersonic-5.png" },
      { name: "Lacoste AG LT 23 Ultra", image: "images/Lacoste-AG-LT-23-Ultra.png" },
      { name: "Yonex PC Eclipsion 5", image: "images/Yonex-PC-Eclipsion-5.png" },
      { name: "Adidas Adizero Cybersonic 2", image: "images/Adidas-adizero-Cybersonic2.png" }
    ];

    const backgroundSelect = document.getElementById('background-select');
    const shoe1Select = document.getElementById('shoe1-select');
    const shoe2Select = document.getElementById('shoe2-select');
    const shoeLayer = document.getElementById('shoe-layer');
    const templateImg = document.getElementById('template');

    // Populate shoe dropdowns
    shoes.forEach((shoe, index) => {
      const option1 = document.createElement('option');
      option1.value = index;
      option1.textContent = shoe.name;
      shoe1Select.appendChild(option1);

      const option2 = document.createElement('option');
      option2.value = index;
      option2.textContent = shoe.name;
      shoe2Select.appendChild(option2);
    });

    // Update template image when background changes
    backgroundSelect.addEventListener('change', () => {
      templateImg.src = `images/${backgroundSelect.value}`;
      updateDisplay();
    });

    function placeShoe(displayIndex, box) {
      if (displayIndex === "") return null;

      const img = document.createElement('img');
      img.src = shoes[displayIndex].image;
      img.className = 'absolute';

      const displayImg = new Image();
      displayImg.src = shoes[displayIndex].image;
      displayImg.onload = () => {
        const scale = templateImg.clientWidth / BASE_WIDTH;

        const displayX = box.x * scale;
        const displayY = box.y * scale;

        const displayWidth = displayImg.width * scale;
        const displayHeight = displayImg.height * scale;

        img.style.width = `${displayWidth}px`;
        img.style.height = `${displayHeight}px`;
        img.style.left = `${displayX}px`;
        img.style.top = `${displayY}px`;

        shoeLayer.appendChild(img);
      };
      return img;
    }

    function updateDisplay() {
      shoeLayer.innerHTML = '';
      placeShoe(shoe1Select.value, shoeBox1);
      placeShoe(shoe2Select.value, shoeBox2);
    }

    shoe1Select.addEventListener('change', updateDisplay);
    shoe2Select.addEventListener('change', updateDisplay);
    window.addEventListener('resize', updateDisplay);

    // Download full-size image with both shoes
    document.getElementById('download-btn').addEventListener('click', () => {
      const canvas = document.createElement('canvas');
      canvas.width = BASE_WIDTH;
      canvas.height = BASE_HEIGHT;
      const ctx = canvas.getContext('2d');

      const template = new Image();
      template.src = `images/${backgroundSelect.value}`;
      template.onload = () => {
        ctx.drawImage(template, 0, 0, BASE_WIDTH, BASE_HEIGHT);

        // Draw first shoe
        const selectedIndex1 = shoe1Select.value;
        const selectedIndex2 = shoe2Select.value;

        function drawShoe(index, box, callback) {
          if (index === "") { callback(); return; }
          const shoe = new Image();
          shoe.src = shoes[index].image;
          shoe.onload = () => {
            ctx.drawImage(shoe, box.x, box.y, shoe.width, shoe.height);
            callback();
          };
        }

        drawShoe(selectedIndex1, shoeBox1, () => {
          drawShoe(selectedIndex2, shoeBox2, () => {
            const link = document.createElement('a');
            link.download = 'shoe-placement.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
          });
        });
      };
    });

  </script>

</body>
</html>
